(this.webpackJsonpbishe=this.webpackJsonpbishe||[]).push([[0],{105:function(e,t,n){},106:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=106},117:function(e,t,n){"use strict";n.r(t);var o,i,c=n(19),s=n(78),r=(n(105),n(123)),l=n(122),u=n(125),d=n(94),a=n(126),h=n(42),j=n(121),f=n(124),b=n(127),p=n(128),y=n(129),x=n(130),g=n(0),m={host:"192.168.43.174",port:9e3,path:"/",debug:3,config:{iceServers:[{url:"stun:stun01.sipphone.com"},{url:"stun:stun.ekiga.net"},{url:"stun:stun.fwdnet.net"},{url:"stun:stun.ideasip.com"},{url:"stun:stun.iptel.org"},{url:"stun:stun.rixtelecom.se"},{url:"stun:stun.schlund.de"},{url:"stun:stun.l.google.com:19302"},{url:"stun:stun1.l.google.com:19302"},{url:"stun:stun2.l.google.com:19302"},{url:"stun:stun3.l.google.com:19302"},{url:"stun:stun4.l.google.com:19302"},{url:"stun:stunserver.org"},{url:"stun:stun.softjoys.com"},{url:"stun:stun.voiparound.com"},{url:"stun:stun.voipbuster.com"},{url:"stun:stun.voipstunt.com"},{url:"stun:stun.voxgratia.org"},{url:"stun:stun.xten.com"},{url:"turn:numb.viagenie.ca",credential:"muazkh",username:"webrtc@live.com"},{url:"turn:192.158.29.39:3478?transport=udp",credential:"JZEOEt2V3Qb0y27GRntt2u2PAYA=",username:"28224511:1379330808"},{url:"turn:192.158.29.39:3478?transport=tcp",credential:"JZEOEt2V3Qb0y27GRntt2u2PAYA=",username:"28224511:1379330808"}]}},v=n(85),O=n.n(v),w=n(99),k=n(11),C=r.a.Header,I=(r.a.Content,r.a.Footer),E=l.a.Title,S=l.a.Text,z="key"+Math.floor(1e6*Math.random()),R=0,D=0;function T(){var e=Object(g.useState)(!1),t=Object(s.a)(e,2),n=t[0],c=t[1],l=Object(g.useState)(),v=Object(s.a)(l,2),T=v[0],A=v[1],B=Object(g.useState)(!1),N=Object(s.a)(B,2),F=N[0],J=N[1],M=Object(g.useRef)(null),_=Object(g.useCallback)((function(e){console.log("handleCall",e),!n&&c(!0);return navigator.getUserMedia({video:!0,audio:!0},(function(t){try{var n=document.getElementById("video1");n&&(n.srcObject=t,n.play()),e?e.answer(t):e=o.call(T,t),e.on("stream",(function(e){var t=document.getElementById("video2");t&&(t.srcObject=e,t.play())}))}catch(i){console.error("video play error")}}),(function(){return console.log("error")})),e}),[T,n]),G=function(e){return function(t){try{if(console.log("receive data: ",t,"type:"+t.type),"conn_build"===t.type)u.a.confirm({title:"\u6536\u5230\u901a\u8bdd\u8bf7\u6c42",content:"\u6765\u81ea"+t.payload.key+"\u7684\u901a\u8bdd\u8bf7\u6c42",onCancel:function(){e.send({type:"refuse"}),setTimeout((function(){return e.close()}),1e3)},onOk:function(){e.send({type:"comfirm"})}});else if("comfirm"===t.type)console.log("comfirm"),d.b.success("\u5bf9\u65b9\u5df2\u63a5\u53d7\u9080\u8bf7"),_();else if("refuse"===t.type)d.b.error("\u5bf9\u65b9\u5df2\u62d2\u7edd\u9080\u8bf7"),A(void 0),setTimeout((function(){return e.close()}),1e3);else if("close"===t.type)d.b.error("\u5bf9\u65b9\u5df2\u6302\u65ad"),A(void 0),setTimeout((function(){return e.close()}),1e3);else if("white"===t.type)J(t.payload);else if("draw"===t.type){var n=Date.now();n-D>1e3&&(M.current.loadSaveData(t.payload.data),R=n)}}catch(o){console.log("\u6240\u63a5\u53d7\u6570\u636e\u683c\u5f0f\u9519\u8bef")}}};return Object(g.useEffect)((function(){o||(o=new O.a(z,m),console.log("test",o),o.on("error",(function(){d.b.error("\u521d\u59cb\u5316\u8fde\u63a5\u5931\u8d25")})),o.on("open",(function(){console.log("\u81ea\u52a8\u6ce8\u518c\u6210\u529f")})),o.on("call",(function(e){_(e)})),o.on("connection",(function(e){i=e,e.on("data",G(e))})),o.on("close",(function(){d.b.error("\u901a\u8bdd\u5df2\u6302\u65ad")})))}),[]),Object(g.useEffect)((function(){var e;return T&&((e=o.connect(T)).on("error",(function(){d.b.error("\u8fde\u63a5\u5931\u8d25")})),e.on("open",(function(){console.log("\u5df2\u53d1\u9001\u8fde\u63a5\u8bf7\u6c42"),e.send({type:"conn_build",payload:{key:z}})})),i=e,e.on("data",G(e))),function(){console.log("inputValue hook clean",e),e&&(e.send({type:"close"}),setTimeout((function(){e.close()}),1e3))}}),[T]),Object(g.useEffect)((function(){if(!T){var e=document.getElementById("video1"),t=document.getElementById("video2");e.pause(),t.pause(),n&&c(!1)}}),[T]),Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)("div",{style:{zIndex:10,background:"rgba(255, 255, 255, 0.5)",display:F?"":"none",position:"fixed",width:"100vw",height:"100vh"},children:Object(k.jsx)(w.a,{ref:function(e){return M.current=e},lazyRadius:5,brushRadius:2,hideGrid:!0,style:{width:"100vw",height:"100vh",background:"none"},onChange:function(e){console.log(M.current.getSaveData());var t,n=Date.now();n-R>1e3&&(null===(t=i)||void 0===t||t.send({type:"draw",payload:{data:M.current.getSaveData()}}),D=n)}})}),Object(k.jsxs)(r.a,{className:"layout",style:{minHeight:"100vh"},children:[Object(k.jsx)(C,{children:Object(k.jsx)("div",{style:{color:"white",fontSize:"20px"},children:Object(k.jsxs)(a.b,{size:"middle",children:[Object(k.jsx)(b.a,{}),"\u5728\u7ebf\u6388\u8bfe\u7cfb\u7edf",Object(k.jsx)(h.a,{onClick:function(){return document.documentElement.requestFullscreen()},children:"\u5168\u5c4f"})]})})}),Object(k.jsxs)("div",{className:"panel",style:{display:n?"none":"flex",justifyContent:"center",alignItems:"center",height:"80vh"},children:[Object(k.jsx)(j.a,{style:{width:"500px",height:"300px",margin:"32px"},children:Object(k.jsxs)(a.b,{direction:"vertical",children:[Object(k.jsx)(E,{level:4,children:"\u57fa\u672c\u4fe1\u606f"}),Object(k.jsxs)("div",{style:{fontSize:"16px"},children:["\u4e2a\u4ebaID\uff1a",Object(k.jsx)(S,{type:"secondary",children:z})]}),Object(k.jsxs)("div",{style:{fontSize:"16px"},children:["\u5728\u7ebf\u65f6\u957f\uff1a",Object(k.jsx)(S,{type:"secondary",children:"<10\u5206\u949f"})]})]})}),Object(k.jsx)(j.a,{style:{width:"500px",height:"300px"},children:Object(k.jsxs)(a.b,{direction:"vertical",style:{width:"100%"},children:[Object(k.jsx)(E,{level:4,children:"\u53d1\u8d77\u804a\u5929"}),Object(k.jsx)("div",{children:Object(k.jsx)(f.a.Search,{onSearch:function(e){return A(e)},placeholder:"\u8bf7\u8f93\u5165\u5bf9\u65b9\u7684ID"})})]})})]}),Object(k.jsxs)("div",{className:"videos",style:{display:n?"":"none"},children:[Object(k.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"80vh"},children:[Object(k.jsx)("div",{style:{margin:"32px"},children:Object(k.jsx)("video",{style:{width:"100%",height:"100%"},id:"video1"})}),Object(k.jsx)("div",{style:{margin:"32px"},children:Object(k.jsx)("video",{style:{width:"100%",height:"100%"},id:"video2"})})]}),Object(k.jsx)("div",{style:{zIndex:100,position:"fixed",right:"0",bottom:"100px",padding:"16px"},children:Object(k.jsxs)(a.b,{style:{width:"100%"},direction:"vertical",size:"large",children:[Object(k.jsxs)("div",{onClick:function(){window.location.reload()},style:{display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(k.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",fontSize:"24px",color:"white",width:"48px",height:"48px",background:"#1890ff",borderRadius:"100%",marginRight:"16px"},children:Object(k.jsx)(p.a,{})}),"\u6302\u65ad\u901a\u8bdd"]}),Object(k.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(k.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",fontSize:"24px",color:"white",width:"48px",height:"48px",background:"#1890ff",borderRadius:"100%",marginRight:"16px"},onClick:function(){J((function(e){return i.send({type:"white",payload:!e}),!e}))},children:Object(k.jsx)(y.a,{})}),"\u5f00\u542f\u767d\u677f"]}),Object(k.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(k.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",fontSize:"24px",color:"white",width:"48px",height:"48px",background:"#1890ff",borderRadius:"100%",marginRight:"16px"},children:Object(k.jsx)(x.a,{})}),"\u53d1\u9001\u6587\u4ef6"]})]})})]}),Object(k.jsxs)(I,{style:{width:"100%",textAlign:"center",position:"fixed",left:"0",bottom:"0",background:"white"},children:[" ","\xa92021 Designed by Rui"]})]})]})}var A=document.getElementById("root");Object(c.render)(Object(k.jsx)(T,{}),A)}},[[117,1,2]]]);
//# sourceMappingURL=main.debb11e8.chunk.js.map